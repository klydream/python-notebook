Host: Debian OS

(1) Download source to host OS
$ cd ~/src/
$ git clone https://github.com/zenodo/zenodo.git

(2) Start docker containers build in step2. This step could be done before step9.
docker-compose up db es cache mq
问题1：docker下载速度较慢：解决方法：
1、阿里加速器：https://cr.console.aliyun.com/#/accelerator；
2、
sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json <<-'EOF'
{
  "registry-mirrors": ["https://htxclokc.mirror.aliyuncs.com"]
}
EOF
sudo systemctl daemon-reload
sudo systemctl restart docker
问题2：阿里云访问github速度过慢导致RUN plugin install royrusso/elasticsearch-HQ/v2.0.3总是失败：
docker运行的应该是elasticsearch的内部命令，运行该命令之后会返回几个网址，挑选合适的下载，实际上只有一个网址可用，https://github.com/ElasticHQ/elasticsearch-HQ/archive/v2.0.3.zip，本地直接下载后，上传到/root/src/zenodo/docker/es/src下，这个有严格的要求，需要位于docker文件所在的根目录。然后再dock/es/Dockerfile里添加本地文件和容器内的映射关系，修改完代码如下：

FROM elasticsearch:2
ADD ./src /src
RUN plugin install file:///src/elasticsearch-HQ-2.0.3.zip
RUN plugin install mapper-attachments


(4) Check and clean OS default python environment.  Uninstall python2 and keep/install python3 only.

(5) Install 2 python modules: virtualenv and virtualenvwrapper.
pip install virtualenv
pip install virtualenvwrapper

(6) Install nodejs on host os
curl -sL https://deb.nodesource.com/setup_6.x | bash - && apt-get -qy install --fix-missing --no-install-recommends nodejs 

(7) Create virtual python environment
mkdir /home/envs
### Append following 3 lines to the end of ~/.bashrc file, and do "source ~/.bashrc" after saving the file.
    export WORKON_HOME=home/.virtualenvs
    export PROJECT_HOME=home/envs
    source /usr/local/bin/virtualenvwrapper.sh
mkvirtualenv zenodo

(8) Build zenodo on host os, this should be done under virtual python environment created in step7.
(zenodo)$
(zenodo)$ cd ~/src/zenodo
(zenodo)$ pip install -r requirements.txt --src ~/src/ --pre --upgrade
(zenodo)$ pip install -e .[all,postgresql,elasticsearch2]
(zenodo)$ ./scripts/setup-npm.sh
(zenodo)$ ./scripts/setup-assets.sh

(9) Initialize zenodo:
(zenodo)$ ./scripts/init.sh


